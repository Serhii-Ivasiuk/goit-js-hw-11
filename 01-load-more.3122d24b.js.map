{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,aAKA,MAAMC,EAAY,IAAI,E,WAAAC,eAEhBC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,QAASF,SAASC,cAAc,YAChCE,YAAaH,SAASC,cAAc,eAGtC,IAAIG,EAAiB,KA8FrB,SAASC,EAAYC,GACnBA,EAAKC,KACH,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,MAEAhB,EAAKI,QAAQa,mBACX,YACA,sBACWN,kEAEKD,WAAsBE,4IAI5BC,6GAIAC,gHAIAC,iHAIAC,sFAMX,G,CAKP,SAASE,IACPlB,EAAKI,QAAQa,mBACX,YACA,kF,CAQJ,SAASE,EAAmBC,GAC1BpB,EAAKK,YAAYgB,MAAMC,QAAUF,EAAU,QAAU,M,CAOvD,SAASG,EAAiBC,EAAMC,GAC9B,OAAOC,EAAA9B,GAAS+B,OAAOH,GAAMC,EAAS,CACpCG,SAAU,gBACVC,cAAc,G,CA7JlB7B,EAAKC,KAAK6B,iBAAiB,UAK3BC,eAAgCC,GAW9B,GAVAA,EAAEC,iBAEFd,GAAmB,GA8IrB,WACEnB,EAAKI,QAAQ8B,UAAY,E,CA7IzBC,GAEArC,EAAUsC,YAEVtC,EAAUuC,MAAQL,EAAEM,OAAOC,SAASC,YAAYC,MAAMC,OAE9B,KAApB5C,EAAUuC,MAIZ,OAHArC,EAAKC,KAAK0C,aAEVpB,EAAiB,OAAQ,sCAI3B,IACE,MACEqB,KAAMC,EACNC,UAAWC,EACXC,MAAOC,SACCnD,EAAUoD,YAEpB,GAAiB,IAAbD,EAKF,YAJA1B,EACE,UACA,4EAWJ,GANAA,EAAiB,UAAW,oBAAoBwB,aAEhDxC,EAAYsC,GAEZvC,EAAiB,IAAIoB,EAAAyB,GAAJ,CAAmB,cAEhCJ,EAAgBjD,EAAUsD,KAAOtD,EAAUuD,QAO7C,OANAlC,GAAmB,GACnBI,EACE,OACA,mEAEFL,IAIFC,GAAmB,E,CACnB,MACAI,EACE,UACA,kD,KAzDNvB,EAAKK,YAAYyB,iBAAiB,SA8DlCC,iBACEjC,EAAUwD,gBAEV,IACE,MAAQV,KAAMC,EAAQC,UAAWC,SACzBjD,EAAUoD,YAElB3C,EAAYsC,GA2FhB,WACE,MAAQU,OAAQC,GACdxD,EAAKI,QAAQqD,kBAAkBC,wBAEjCC,OAAOC,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CA/FVC,GAEAzD,EAAe0D,UAEXjB,EAAgBjD,EAAUsD,KAAOtD,EAAUuD,UAC7ClC,GAAmB,GACnBI,EACE,OACA,8DAEFL,I,CAEF,MACAK,EACE,UACA,kD,KApFNJ,GAAmB","sources":["src/js/01-load-more.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { ImagesService } from './services/get-images-service';\n\nconst ImagesApi = new ImagesService();\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nlet simpleLightbox = null;\n\nrefs.form.addEventListener('submit', handleFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMoreBtnClick);\n\nisLoadMoreBtnShown(false);\n\nasync function handleFormSubmit(e) {\n  e.preventDefault();\n\n  isLoadMoreBtnShown(false);\n\n  clearMarkup();\n\n  ImagesApi.pageReset();\n\n  ImagesApi.query = e.target.elements.searchQuery.value.trim();\n\n  if (ImagesApi.query === '') {\n    refs.form.reset();\n\n    showNotification('info', 'Please, enter your search request.');\n    return;\n  }\n\n  try {\n    const {\n      hits: images,\n      totalHits: totalQuantity,\n      total: quantity,\n    } = await ImagesApi.getImages();\n\n    if (quantity === 0) {\n      showNotification(\n        'failure',\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    showNotification('success', `Hooray! We found ${totalQuantity} images.`);\n\n    renderCards(images);\n\n    simpleLightbox = new SimpleLightbox('.gallery a');\n\n    if (totalQuantity < ImagesApi.page * ImagesApi.perPage) {\n      isLoadMoreBtnShown(false);\n      showNotification(\n        'info',\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      renderEndMessage();\n      return;\n    }\n\n    isLoadMoreBtnShown(true);\n  } catch {\n    showNotification(\n      'failure',\n      'Something went wrong... Please try again later.'\n    );\n  }\n}\n\nasync function handleLoadMoreBtnClick() {\n  ImagesApi.incrementPage();\n\n  try {\n    const { hits: images, totalHits: totalQuantity } =\n      await ImagesApi.getImages();\n\n    renderCards(images);\n\n    autoScrollPage();\n\n    simpleLightbox.refresh();\n\n    if (totalQuantity < ImagesApi.page * ImagesApi.perPage) {\n      isLoadMoreBtnShown(false);\n      showNotification(\n        'info',\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      renderEndMessage();\n    }\n  } catch {\n    showNotification(\n      'failure',\n      'Something went wrong... Please try again later.'\n    );\n  }\n}\n\nfunction renderCards(data) {\n  data.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      refs.gallery.insertAdjacentHTML(\n        'beforeend',\n        `\n        <a href=\"${largeImageURL}\">\n          <div class=\"photo-card\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                ${downloads}\n              </p>\n            </div>\n          </div>\n        </a>\n        `\n      );\n    }\n  );\n}\n\nfunction renderEndMessage() {\n  refs.gallery.insertAdjacentHTML(\n    'beforeend',\n    `\n    <p class=\"end-message\">\n      The end of search results.\n    </p>\n    `\n  );\n}\n\nfunction isLoadMoreBtnShown(boolean) {\n  refs.loadMoreBtn.style.display = boolean ? 'block' : 'none';\n}\n\nfunction clearMarkup() {\n  refs.gallery.innerHTML = '';\n}\n\nfunction showNotification(type, message) {\n  return Notiflix.Notify[type](message, {\n    position: 'center-center',\n    clickToClose: true,\n  });\n}\n\nfunction autoScrollPage() {\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$7Y9D8","parcelRequire","$1280f960daaf59c1$var$ImagesApi","ImagesService","$1280f960daaf59c1$var$refs","form","document","querySelector","gallery","loadMoreBtn","$1280f960daaf59c1$var$simpleLightbox","$1280f960daaf59c1$var$renderCards","data","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","insertAdjacentHTML","$1280f960daaf59c1$var$renderEndMessage","$1280f960daaf59c1$var$isLoadMoreBtnShown","boolean","style","display","$1280f960daaf59c1$var$showNotification","type","message","$parcel$interopDefault","Notify","position","clickToClose","addEventListener","async","e","preventDefault","innerHTML","$1280f960daaf59c1$var$clearMarkup","pageReset","query","target","elements","searchQuery","value","trim","reset","hits","images","totalHits","totalQuantity","total","quantity","getImages","$fZKcF","page","perPage","incrementPage","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$1280f960daaf59c1$var$autoScrollPage","refresh"],"version":3,"file":"01-load-more.3122d24b.js.map"}