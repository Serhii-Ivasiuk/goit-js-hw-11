{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,aAKA,MAAMC,EAAY,IAAI,E,WAAAC,eAEhBC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,QAASF,SAASC,cAAc,YAChCE,YAAaH,SAASC,cAAc,eAGtC,IAAIG,EAAiB,KAoFrB,SAASC,EAAYC,GACnBA,EAAKC,KACH,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,MAEAhB,EAAKI,QAAQa,mBACX,YACA,sBACWN,kEAEKD,WAAsBE,4IAI5BC,6GAIAC,gHAIAC,iHAIAC,sFAMX,G,CAgBP,SAASE,EAAmBC,GAC1BnB,EAAKK,YAAYe,MAAMC,QAAUF,EAAU,QAAU,M,CAOvD,SAASG,EAAiBC,EAAMC,GAC9B,OAAOC,EAAA7B,GAAS8B,OAAOH,GAAMC,E,CAjJ/BxB,EAAKC,KAAK0B,iBAAiB,UAK3BC,eAAgCC,GAW9B,GAVAA,EAAEC,iBAEFZ,GAAmB,GAoIrB,WACElB,EAAKI,QAAQ2B,UAAY,E,CAnIzBC,GAEAlC,EAAUmC,YAEVnC,EAAUoC,MAAQL,EAAEM,OAAOC,SAASC,YAAYC,MAAMC,OAE9B,KAApBzC,EAAUoC,MAIZ,OAHAlC,EAAKC,KAAKuC,aAEVlB,EAAiB,OAAQ,sCAI3B,IACE,MACEmB,KAAMC,EACNC,UAAWC,EACXC,MAAOC,SACChD,EAAUiD,YAEpB,GAAiB,IAAbD,EAKF,YAJAxB,EACE,UACA,4EAKJA,EAAiB,UAAW,oBAAoBsB,aAEhDrC,EAAYmC,GAEZpC,EAAiB,IAAImB,EAAAuB,GAAJ,CAAmB,cAEpC9B,GAAmB,E,CACnB,MACAI,EACE,UACA,kD,KA/CNtB,EAAKK,YAAYsB,iBAAiB,SAoDlCC,iBACE9B,EAAUmD,gBAEV,IACE,MAAQR,KAAMC,EAAQC,UAAWC,SACzB9C,EAAUiD,YAElBxC,EAAYmC,GAwFhB,WACE,MAAQQ,OAAQC,GACdnD,EAAKI,QAAQgD,kBAAkBC,wBAEjCC,OAAOC,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CA5FVC,GAEApD,EAAeqD,UAEXf,EAAgB9C,EAAU8D,KAAO9D,EAAU+D,UAC7C3C,GAAmB,GACnBI,EACE,OACA,8DAwDNtB,EAAKI,QAAQa,mBACX,YACA,mF,CAtDA,MACAK,EACE,UACA,kD,KA1ENJ,GAAmB","sources":["src/js/01-load-more.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { ImagesService } from './services/get-images-service';\n\nconst ImagesApi = new ImagesService();\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nlet simpleLightbox = null;\n\nrefs.form.addEventListener('submit', handleFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMoreBtnClick);\n\nisLoadMoreBtnShown(false);\n\nasync function handleFormSubmit(e) {\n  e.preventDefault();\n\n  isLoadMoreBtnShown(false);\n\n  clearMarkup();\n\n  ImagesApi.pageReset();\n\n  ImagesApi.query = e.target.elements.searchQuery.value.trim();\n\n  if (ImagesApi.query === '') {\n    refs.form.reset();\n\n    showNotification('info', 'Please, enter your search request.');\n    return;\n  }\n\n  try {\n    const {\n      hits: images,\n      totalHits: totalQuantity,\n      total: quantity,\n    } = await ImagesApi.getImages();\n\n    if (quantity === 0) {\n      showNotification(\n        'failure',\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    showNotification('success', `Hooray! We found ${totalQuantity} images.`);\n\n    renderCards(images);\n\n    simpleLightbox = new SimpleLightbox('.gallery a');\n\n    isLoadMoreBtnShown(true);\n  } catch {\n    showNotification(\n      'failure',\n      'Something went wrong... Please try again later.'\n    );\n  }\n}\n\nasync function handleLoadMoreBtnClick() {\n  ImagesApi.incrementPage();\n\n  try {\n    const { hits: images, totalHits: totalQuantity } =\n      await ImagesApi.getImages();\n\n    renderCards(images);\n\n    autoScrollPage();\n\n    simpleLightbox.refresh();\n\n    if (totalQuantity < ImagesApi.page * ImagesApi.perPage) {\n      isLoadMoreBtnShown(false);\n      showNotification(\n        'info',\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      renderEndMessage();\n    }\n  } catch {\n    showNotification(\n      'failure',\n      'Something went wrong... Please try again later.'\n    );\n  }\n}\n\nfunction renderCards(data) {\n  data.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      refs.gallery.insertAdjacentHTML(\n        'beforeend',\n        `\n        <a href=\"${largeImageURL}\">\n          <div class=\"photo-card\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                ${downloads}\n              </p>\n            </div>\n          </div>\n        </a>\n        `\n      );\n    }\n  );\n}\n\nfunction renderEndMessage() {\n  refs.gallery.insertAdjacentHTML(\n    'beforeend',\n    `\n    <p class=\"end-message\">\n      The end of search results.\n    </p>\n    `\n  );\n}\n\nfunction isLoadMoreBtnShown(boolean) {\n  refs.loadMoreBtn.style.display = boolean ? 'block' : 'none';\n}\n\nfunction clearMarkup() {\n  refs.gallery.innerHTML = '';\n}\n\nfunction showNotification(type, message) {\n  return Notiflix.Notify[type](message);\n}\n\nfunction autoScrollPage() {\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$7Y9D8","parcelRequire","$1280f960daaf59c1$var$ImagesApi","ImagesService","$1280f960daaf59c1$var$refs","form","document","querySelector","gallery","loadMoreBtn","$1280f960daaf59c1$var$simpleLightbox","$1280f960daaf59c1$var$renderCards","data","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","insertAdjacentHTML","$1280f960daaf59c1$var$isLoadMoreBtnShown","boolean","style","display","$1280f960daaf59c1$var$showNotification","type","message","$parcel$interopDefault","Notify","addEventListener","async","e","preventDefault","innerHTML","$1280f960daaf59c1$var$clearMarkup","pageReset","query","target","elements","searchQuery","value","trim","reset","hits","images","totalHits","totalQuantity","total","quantity","getImages","$fZKcF","incrementPage","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$1280f960daaf59c1$var$autoScrollPage","refresh","page","perPage"],"version":3,"file":"01-load-more.ba679c91.js.map"}